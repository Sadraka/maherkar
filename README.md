# پروژه ماهرکار

پلتفرم کاریابی ساده و کارآمد که امکان انتشار آگهی‌های شغلی و ارتباط کارفرمایان و کارجویان را فراهم می‌کند.

<div dir="rtl">

## فهرست مطالب
- [معرفی](#معرفی)
- [سیستم احراز هویت](#سیستم-احراز-هویت)
  - [ویژگی‌های کلیدی سیستم احراز هویت](#ویژگیهای-کلیدی-سیستم-احراز-هویت)
  - [کاربرد Context در احراز هویت](#کاربرد-context-در-احراز-هویت)
- [بخش فرانت‌اند](#بخش-فرانتاند)
  - [تکنولوژی‌های فرانت‌اند](#تکنولوژیهای-فرانتاند)
  - [ساختار فرانت‌اند](#ساختار-فرانتاند)
  - [کامپوننت‌های اصلی](#کامپوننتهای-اصلی)
  - [ویژگی‌های خاص](#ویژگیهای-خاص-فرانتاند)
- [بخش بک‌اند](#بخش-بکاند)
  - [تکنولوژی‌های بک‌اند](#تکنولوژیهای-بکاند)
  - [ساختار بک‌اند](#ساختار-بکاند)
  - [ویژگی‌های کلیدی](#ویژگیهای-کلیدی-بکاند)
  - [نقاط قوت معماری](#نقاط-قوت-معماری)
- [نصب و راه‌اندازی](#نصب-و-راهاندازی)
  - [پیش‌نیازها](#پیشنیازها)
  - [راه‌اندازی بک‌اند](#راهاندازی-بکاند)
  - [راه‌اندازی فرانت‌اند](#راهاندازی-فرانتاند)
- [معماری پروژه](#معماری-پروژه)

## معرفی

ماهرکار یک پلتفرم کاریابی آنلاین است که برای تسهیل ارتباط کارفرمایان و کارجویان طراحی شده است. این سیستم امکان ایجاد آگهی‌های شغلی توسط کارفرمایان و همچنین ثبت رزومه و جستجوی کار توسط کارجویان را فراهم می‌کند.

پروژه ماهرکار از دو بخش اصلی فرانت‌اند و بک‌اند تشکیل شده است که هر کدام با استفاده از تکنولوژی‌های مدرن و روش‌های بهینه توسعه نرم‌افزار پیاده‌سازی شده‌اند.

## سیستم احراز هویت

سیستم احراز هویت ماهرکار بر اساس OTP (رمز یکبار مصرف) طراحی شده است که یک روش امن و کاربرپسند برای احراز هویت کاربران محسوب می‌شود. این سیستم از ورود مستقیم با شماره تلفن و کد تایید استفاده می‌کند.

### ویژگی‌های کلیدی سیستم احراز هویت

1. **ورود و ثبت‌نام با OTP**: 
   - ورود با شماره تلفن بدون نیاز به رمز عبور دائمی
   - ارسال کد تایید 6 رقمی به شماره تلفن کاربر
   - مدیریت وضعیت OTP (اعتبارسنجی، زمان انقضا)

2. **کامپوننت اختصاصی OTP**:
   - پیاده‌سازی کامل کامپوننت `OtpInput` برای ورود کد تایید
   - بهینه‌سازی برای کاربری راحت‌تر با پشتیبانی از:
     - ورود اتوماتیک اعداد
     - امکان کپی و پیست کد کامل
     - اعتبارسنجی خودکار فرمت کد
     - حرکت اتوماتیک بین فیلدها
     - نمایش مناسب خطاها
     - سازگاری با زبان فارسی و RTL

3. **فرم‌های احراز هویت**:
   - **فرم ورود (`LoginForm`)**:
     - فرایند دو مرحله‌ای: ورود شماره تلفن → دریافت و تایید کد
     - امکان ارسال مجدد کد با تایمر محدودیت زمانی
     - پیاده‌سازی در کامپوننت `LoginForm` با ساختار مرحله‌ای

   - **فرم ثبت‌نام (`RegisterForm`)**:
     - فرایند سه مرحله‌ای: ورود شماره تلفن → تکمیل اطلاعات → دریافت و تایید کد
     - انتخاب نوع کاربر (کارجو یا کارفرما)
     - نمایش مناسب با استفاده از `Stepper` برای نمایش مراحل

4. **چالش‌های فنی حل شده**:
   - **چالش جهت LTR/RTL**: رفع مشکل نمایش فیلدهای OTP که باید به صورت چپ به راست (LTR) نمایش داده شوند، در محیط کلی سایت که راست به چپ (RTL) است.
     ```tsx
     // راه‌حل: معکوس کردن ترتیب فیلدها برای نمایش صحیح
     const renderInputs = () => {
       const inputs = [];
       // ایجاد فیلدها
       // ...
       return inputs.reverse(); // معکوس کردن ترتیب برای نمایش LTR در محیط RTL
     };
     ```
   
   - **مدیریت خطای کد نادرست**: نمایش پیام خطا با استایل مناسب
     ```tsx
     // راه‌حل: ایجاد کامپوننت مستقل برای نمایش خطا
     const ErrorMessage = ({ message }: { message: string }) => {
       return (
         <div style={{
           width: '100%',
           textAlign: 'center',
           color: '#d32f2f',
           marginTop: '20px',
           direction: 'rtl'
         }} dir="rtl">
           {message}
         </div>
       );
     };
     ```
   
   - **چالش تایمر OTP**: پیاده‌سازی تایمر محدودیت ارسال مجدد کد با ذخیره‌سازی در localStorage
     ```tsx
     // تنظیم تایمر و ذخیره در localStorage
     setResendTimer(120);
     const now = new Date().getTime();
     const endTime = now + (120 * 1000); // 120 ثانیه بعد
     localStorage.setItem(`otp_timer_${phoneKey}`, JSON.stringify({ endTime }));
     ```
   
   - **مطابقت با Next.js 15**: اصلاح ساختار کامپوننت‌ها برای سازگاری با الزامات جدید Next.js 15
     ```tsx
     // استفاده از Suspense برای هوک useSearchParams
     export default function LoginForm({ onSuccess }: LoginFormProps) {
         return (
             <Suspense fallback={<Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '200px' }}><CircularProgress /></Box>}>
                 <LoginFormContent onSuccess={onSuccess} />
             </Suspense>
         );
     }
     ```

5. **مزیت‌های کلیدی پیاده‌سازی**:
   - **امنیت بالاتر**: استفاده از OTP به جای رمز عبور دائمی
   - **تجربه کاربری بهبودیافته**: فرایند ورود ساده‌تر و سریع‌تر
   - **انعطاف‌پذیری**: امکان استفاده مجدد از کامپوننت OTP در سایر بخش‌ها

### کاربرد Context در احراز هویت

برای مدیریت وضعیت احراز هویت، از یک AuthContext استفاده شده است که در سراسر برنامه قابل دسترسی است:

```tsx
// استفاده از AuthContext
const { isAuthenticated, user, loading } = useAuth();
```

این کانتکست متدهای زیر را در اختیار کامپوننت‌ها قرار می‌دهد:

- **loginOtp**: درخواست کد OTP برای ورود
- **validateLoginOtp**: اعتبارسنجی کد OTP وارد شده
- **registerOtp**: درخواست کد OTP برای ثبت‌نام
- **validateOtp**: اعتبارسنجی کد OTP ثبت‌نام
- **checkPhoneExists**: بررسی وجود شماره تلفن در سیستم
- **logout**: خروج از سیستم

### بخش‌های فرانت‌اند

## بخش فرانت‌اند

### تکنولوژی‌های فرانت‌اند
- **فریم‌ورک**: Next.js نسخه 15.3.0 (جدیدترین نسخه)
- **زبان برنامه‌نویسی**: TypeScript
- **کتابخانه UI**: Material UI نسخه 7.0.2 به همراه آیکون‌های MUI
- **استایل‌دهی**: ترکیبی از Material UI و Tailwind CSS
- **مدیریت جهت‌دهی**: استفاده از stylis-plugin-rtl برای پشتیبانی از راست به چپ (RTL)
- **آیکون‌ها**: ترکیبی از Font Awesome و Material Icons

### ساختار فرانت‌اند
1. **پوشه src**: حاوی تمام کدهای اصلی پروژه
   - **app**: صفحات اصلی برنامه با ساختار App Router از Next.js
   - **components**: کامپوننت‌های مختلف تقسیم‌بندی شده در پوشه‌های مختلف
   - **contexts**: حاوی context‌های مختلف برای مدیریت state در سطح برنامه
   - **lib**: کتابخانه‌های کمکی
   - **utils**: توابع کمکی
   - **constants**: ثابت‌های مورد استفاده در برنامه
   - **theme**: تنظیمات مربوط به تم برنامه

### کامپوننت‌های اصلی
1. **Hero**: بخش بالایی صفحه اصلی با امکان جستجوی پیشرفته مشاغل
2. **JobListings**: نمایش آگهی‌های شغلی در صفحه اصلی
3. **Experts**: نمایش متخصصین برتر
4. **CombinedInfo**: ترکیبی از بخش‌های استخدام روزانه و درباره ما
5. **Footer**: بخش انتهایی سایت
6. **JobCard**: کامپوننت نمایش جزئیات آگهی شغلی
7. **AddResumeCard**: کامپوننت اضافه کردن رزومه برای کارجویان
8. **AddJobCard**: کامپوننت اضافه کردن آگهی شغلی برای کارفرمایان
9. **ExpertCard**: کامپوننت نمایش اطلاعات متخصصین
10. **AppHeader**: هدر سایت با منوی ناوبری

### ویژگی‌های خاص فرانت‌اند
1. **پشتیبانی دو زبانه**: طراحی کاملاً راست به چپ برای زبان فارسی
2. **پشتیبانی از دو تم**: تم کارفرما و تم کارجو با رنگ‌های متفاوت
3. **طراحی واکنش‌گرا**: سازگاری کامل با انواع دستگاه‌ها (موبایل، تبلت، دسکتاپ)
4. **کامپوننت‌های شخصی‌سازی شده**: کارت‌های مخصوص برای آگهی‌های شغلی، متخصصین و اضافه کردن رزومه
5. **استفاده از Client Components**: تقریباً تمام کامپوننت‌ها از نوع 'use client' هستند
6. **مدیریت context**: استفاده از JobSeekerThemeContext برای مدیریت تم
7. **تایپ‌های قوی**: تعریف دقیق تایپ‌ها برای داده‌ها مانند JobType

## بخش بک‌اند

### تکنولوژی‌های بک‌اند
- **فریم‌ورک**: Django 5.1.7 (جدیدترین نسخه)
- **API**: Django REST Framework 3.15.2
- **احراز هویت**: JWT (با استفاده از django-rest-framework-simplejwt)
- **پایگاه داده**: SQLite 3 (برای توسعه)
- **ارسال پیامک**: Kavenegar API
- **امنیت**: CORS Headers (cross-origin resource sharing)

### ساختار بک‌اند
بک‌اند پروژه ماهرکار به صورت جامع و با معماری ماژولار طراحی شده است. در این معماری، هر بخش از سیستم به صورت یک اپلیکیشن منطقی مجزا پیاده‌سازی شده است:

1. **Authentication**: سیستم ثبت‌نام و ورود کاربران با OTP
2. **Users**: مدیریت کاربران سیستم
3. **Profiles**: پروفایل‌های کاربری (کارجو و کارفرما)
4. **Companies**: مدیریت شرکت‌ها و اطلاعات مربوط به آن‌ها
5. **Resumes**: مدیریت رزومه‌های کارجویان
6. **Advertisements**: مدیریت آگهی‌های کارفرما و کارجو
7. **Locations**: مدیریت اطلاعات مکانی (استان‌ها و شهرها)
8. **Industry**: مدیریت صنایع و مهارت‌های مرتبط
9. **Subscriptions**: مدیریت اشتراک‌های پرداختی
10. **Orders**: مدیریت سفارش‌ها
11. **Payments**: مدیریت پرداخت‌ها با امکان اتصال به درگاه پرداخت
12. **Reports**: سیستم گزارش‌گیری

### ویژگی‌های کلیدی بک‌اند

#### 1. سیستم احراز هویت
- **ثبت‌نام با OTP**: استفاده از سیستم رمز یکبار مصرف برای ثبت‌نام کاربران
- **JWT**: استفاده از توکن‌های JWT برای احراز هویت کاربران
- **مدیریت توکن‌ها**: توکن‌های refresh و access با طول عمر مشخص

#### 2. سیستم کاربری
- **انواع کاربر**: پشتیبانی از چهار نوع کاربر (کارجو، کارفرما، پشتیبان، مدیر)
- **وضعیت حساب**: مدیریت وضعیت‌های مختلف حساب (فعال، تعلیق شده، حذف شده)
- **اطلاعات هویتی**: ذخیره و اعتبارسنجی اطلاعات کارت ملی

#### 3. مدیریت رزومه‌ها
- **اطلاعات جامع**: ذخیره اطلاعات کامل تحصیلی، کاری و مهارت‌های کارجویان
- **تجربه کاری**: مدیریت سوابق کاری با جزئیات کامل
- **تحصیلات**: مدیریت سوابق تحصیلی
- **مهارت‌ها**: مدیریت مهارت‌ها با سطوح مختلف

#### 4. مدیریت آگهی‌ها
- **انواع آگهی**: پشتیبانی از دو نوع آگهی (کارفرما و کارجو)
- **اطلاعات آگهی**: ذخیره جزئیات کامل آگهی (حقوق، نوع کار، جنسیت، وضعیت سربازی، مدرک)
- **وضعیت آگهی**: کنترل وضعیت آگهی‌ها (در حال بررسی، تایید شده، رد شده)
- **درخواست**: سیستم ارسال درخواست برای آگهی‌های شغلی

#### 5. سیستم اشتراک و پرداخت
- **اشتراک‌ها**: مدیریت انواع اشتراک‌ها برای آگهی‌ها
- **سفارش**: مدیریت سفارش‌های کاربران
- **پرداخت**: مدیریت پرداخت‌ها با امکان اتصال به درگاه پرداخت

### نقاط قوت معماری
1. **تفکیک دغدغه‌ها (Separation of Concerns)**: هر اپلیکیشن Django مسئولیت بخش خاصی از سیستم را به عهده دارد
2. **کدگذاری چندزبانه**: پشتیبانی کامل از زبان فارسی در همه بخش‌ها
3. **مستندسازی کد**: کامنت‌های توضیحی مناسب در تمام فایل‌ها
4. **مدل‌سازی صحیح**: استفاده از روابط مناسب بین مدل‌ها (ForeignKey، OneToOne، ManyToMany)
5. **استفاده از Choices**: استفاده از ساختار TextChoices برای فیلدهای انتخابی
6. **سریالایزرها**: استفاده از سریالایزرهای DRF برای اعتبارسنجی و تبدیل داده‌ها
7. **مجوزها**: تعریف سطوح دسترسی مختلف
8. **APIView**: استفاده از APIView برای تعریف ویوهای REST
9. **مدیریت خطا**: مدیریت خطاهای احتمالی و ارائه پیام‌های خطای مناسب
10. **اسلاگ**: استفاده از اسلاگ برای URL‌های دوستانه

## نصب و راه‌اندازی

### پیش‌نیازها
- Node.js (نسخه 20 به بالا)
- Python (نسخه 3.10 به بالا)
- npm یا yarn
- pip

### راه‌اندازی بک‌اند
1. ابتدا به پوشه بک‌اند بروید:
```bash
cd Backend
```

2. محیط مجازی Python را ایجاد کنید:
```bash
python -m venv venv
```

3. محیط مجازی را فعال کنید:
   - در ویندوز:
   ```bash
   venv\Scripts\activate
   ```
   - در لینوکس/مک:
   ```bash
   source venv/bin/activate
   ```

4. پکیج‌های مورد نیاز را نصب کنید:
```bash
pip install -r requirements.txt
```

5. به پوشه Server بروید:
```bash
cd Server
```

6. دیتابیس را آماده کنید:
```bash
python manage.py migrate
```

7. یک کاربر مدیر ایجاد کنید:
```bash
python manage.py createsuperuser
```

8. سرور را اجرا کنید:
```bash
python manage.py runserver
```

حالا سرور بک‌اند شما روی آدرس http://localhost:8000 در حال اجراست.

### راه‌اندازی فرانت‌اند
1. در ترمینال دیگری، به پوشه اصلی پروژه بروید:
```bash
cd ..
```

2. پکیج‌های مورد نیاز را نصب کنید:
```bash
npm install
# یا
yarn install
```

3. سرور توسعه را اجرا کنید:
```bash
npm run dev
# یا
yarn dev
```

حالا فرانت‌اند شما روی آدرس http://localhost:3000 در حال اجراست.

## معماری پروژه

پروژه ماهرکار از یک معماری لایه‌بندی شده کلاینت-سرور استفاده می‌کند:

1. **لایه نمایش (فرانت‌اند)**:
   - استفاده از Next.js و React برای ساخت رابط کاربری
   - استفاده از Material UI برای کامپوننت‌های آماده و استایل‌دهی
   - مدیریت حالت با استفاده از React Context

2. **لایه سرویس (بک‌اند)**:
   - API RESTful با استفاده از Django REST Framework
   - احراز هویت توسط JWT
   - پردازش منطق کسب و کار در ویوها

3. **لایه داده**:
   - استفاده از SQLite در محیط توسعه (قابل تغییر به PostgreSQL یا MySQL در محیط تولید)
   - مدل‌های جامع Django برای نگهداری ساختار داده

</div>
